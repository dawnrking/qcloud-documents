本文为您介绍通过云数据库 MySQL 控制台设置数据库代理连接地址。

数据库代理连接地址独立于原有的数据库连接地址，通过数据库代理地址的请求全部通过代理集群中转访问数据库的主从节点，进行读写分离，将读请求转发至只读实例，降低主库的负载。
云数据库 MySQL 在开通数据库代理后默认提供一个数据库代理连接地址，您也可以额外新增数据库代理连接地址、修改数据库代理连接地址或删除数据库代理连接地址。

## 前提条件
已 [开通数据库代理](https://cloud.tencent.com/document/product/236/82231)。

## 修改数据库代理连接地址
1. 登录 [MySQL 控制台](https://console.cloud.tencent.com/cdb)，在实例列表，选择已开启代理的主实例，单击实例 ID 或**操作**列的**管理**，进入实例管理页面。
2. 在实例管理页面，选择**数据库代理**页，在**连接地址**的对应**内网访问地址**后单击<img src="https://main.qcloudimg.com/raw/be716b5360d5256a9d5e816e29872ec1.png"  style="margin:0;">图标。
![](https://qcloudimg.tencent-cloud.cn/raw/a88727b33df1a69b5670df3fd778e4d1.png)
3. 在弹出的对话框，修改代理地址后，单击**确定**。
>!修改内网地址会影响正在访问的数据库业务，建议在低峰期修改，请确保业务具备重连机制。
>
![](https://main.qcloudimg.com/raw/1756464b7c6edb3315ec8c1ca2a664a3.png)

## 新增数据库代理连接地址
>?
>- 开通的数据库代理具备多少节点就可以创建多少个连接地址。
>- 开通数据库代理时已默认创建一个连接地址。
>
1. 登录 [MySQL 控制台](https://console.cloud.tencent.com/cdb)，在实例列表，选择已开启代理的主实例，单击实例 ID 或**操作**列的**管理**，进入实例管理页面。
2. 在实例管理页面，选择**数据库代理**页，在**连接地址**后单击**新增访问地址**。
![](https://qcloudimg.tencent-cloud.cn/raw/9d8892612ab653e328c14b6ad87f42a7.png)
3. 在新建连接窗口，完成如下配置，单击**确定**。
**步骤1：配置网络**
<table>
<thead><tr><th>参数</th><th>说明</th></tr></thead>
<tbody><tr>
<td>网络</td>
<td>选择数据库代理的网络，仅支持私有网络 VPC。支持选择自动分配 IP 或指定 IP。</td></tr>
<tr>
<td>安全组</td>
<td>默认选择的安全组与主实例保持一致，也可根据需要选择已有安全组或新建安全组，支持多选安全组。<blockquote class="rno-document-tips rno-document-tips-notice">    <div class="rno-document-tips-body">        <i class="rno-document-tip-icon"></i>        <div class="rno-document-tip-title">注意</div>        <div class="rno-document-tip-desc"><p>访问数据库代理需要开通配置安全策略，放通内网访问端口（当前内网端口为：3306），具体详见 <a href="https://cloud.tencent.com/document/product/236/9537">MySQL 安全组配置</a>。</p></div>    </div></blockquote></td></tr>
<tr>
<td>备注</td>
<td>非必填项，可为新增数据库代理连接地址进行备注。</td></tr>
</tbody></table>
<b>步骤2：配置策略</b>
<table>
<thead><tr><th>参数</th><th>说明</th></tr></thead>
<tbody><tr>
<td>读写属性</td>
<td>选择此代理访问地址的读写属性，支持选择读写分离或只读。</td></tr>
<tr>
<td>只读实例延迟剔除</td>
<td>设置只读实例延迟剔除策略，此项开启，可设置延迟剔除阈值和只读实例最小保留数。无论此项是否启用，只读实例故障时均会尝试剔除和恢复。<ul><li>延迟剔除阈值：输入大于1或等于1的整数，单位为秒。</li><li>只读实例最小保留数：数量与主实例拥有只读实例数相关，设置为0时，当只读节点全部被剔除后，所有访问会转发到主实例上，直至只读实例重新加入。</li></ul></td></tr>
<tr>
<td>连接池状态</td>
<td>连接池功能主要用于减少短连接业务频繁建立新连接带来的实例负载。此项开启，可选择支持的连接池类型，目前默认仅支持会话级连接池。</td></tr>
<tr>
<td>事务拆分</td>
<td>设置是否开启，开启后，在一个事务中拆分读和写到不同的实例上去执行，读请求转发到只读实例，降低主实例负载。</td></tr>
<tr>
<td>读权重分配</td>
<td>支持选择系统自动分配或自定义，如开通数据库代理时配置了多个可用区，则支持对通过不同可用区下的代理节点访问数据库的权重进行分别配置。</td></tr>
<tr>
<td>故障转移（读写属性为读写分离）</td>
<td>设置是否开启，开启后，数据库代理出现故障时，连接地址将会路由到主实例。</td></tr>
<tr>
<td>自动添加只读实例</td>
<td>设置是否开启，开启后，若您购买新的只读实例，会自动添加到数据库代理中。<ul><li>当读权重为系统自动分配时，新购只读实例按照规格大小默认权重分配。</li><li>当读权重为自定义时，新购只读实例默认加入时权重为0，可通过数据库代理页，连接地址下的调整配置来修改。</li></ul></td></tr>
</tbody></table>

## 删除数据库代理连接地址
>?当数据库代理下有多个代理连接地址时，支持删除不需要的连接地址，但最后一个地址不支持删除。
>
1. 登录 [MySQL 控制台](https://console.cloud.tencent.com/cdb)，在实例列表，选择已开启代理的主实例，单击实例 ID 或**操作**列的**管理**，进入实例管理页面。
2. 在实例管理页面，选择**数据库代理**页，在**连接地址**下找到目标地址，单击**关闭**。
![](https://qcloudimg.tencent-cloud.cn/raw/6837f721627fcf0c61a36ac7b4d81898.png)
3. 在弹出的对话框单击**确定**。

